<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>gps-demo</title>
    <script type="module" crossorigin src="./assets/index-Bcef--wg.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-B-OhZVlA.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">import%20marimo%0A%0A__generated_with%20%3D%20%220.14.16%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0Aasync%20with%20app.setup%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20micropip%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20sympy%20as%20sp%0A%0A%20%20%20%20await%20micropip.install(%0A%20%20%20%20%20%20%20%20str(mo.notebook_location()%20%2F%20%22public%22%20%2F%20%22plainll-0.1.0-py3-none-any.whl%22)%0A%20%20%20%20)%0A%20%20%20%20await%20micropip.install(%0A%20%20%20%20%20%20%20%20str(mo.notebook_location()%20%2F%20%22public%22%20%2F%20%22scope-0.1.0-py3-none-any.whl%22)%0A%20%20%20%20)%0A%0A%0A%40app.function%0Adef%20latex_frac(fraction%2C%20strict%3DFalse)%3A%0A%20%20%20%20if%20fraction.denominator%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20return%20str(fraction)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20return%20rf%22%5Cfrac%7B%7B%7Bfraction.numerator%7D%7D%7D%7B%7B%7Bfraction.denominator%7D%7D%7D%22%0A%0A%0A%40app.function%0Adef%20monospace_set(items)%3A%0A%20%20%20%20items%20%3D%20(item.replace(%22_%22%2C%20r%22%5C_%22)%20for%20item%20in%20items)%0A%20%20%20%20return%20r%22%5C%7B%22%20%2B%20%22%2C%22.join(f%22%5C%5Ctexttt%7B%7B%7Bx%7D%7D%7D%22%20for%20x%20in%20items)%20%2B%20r%22%5C%7D%22%0A%0A%0A%40app.cell%0Aasync%20def%20_()%3A%0A%20%20%20%20import%20yaml%0A%20%20%20%20import%20io%0A%20%20%20%20from%20pyodide.http%20import%20open_url%2C%20pyfetch%0A%20%20%20%20from%20scope.data%20import%20CodeGeometry%0A%0A%20%20%20%20tm_path%20%3D%20str(mo.notebook_location()%20%2F%20%22public%22%20%2F%20%22tm%22%20%2F%20%22detectA0.yml%22)%0A%20%20%20%20geo_path%20%3D%20str(%0A%20%20%20%20%20%20%20%20mo.notebook_location()%0A%20%20%20%20%20%20%20%20%2F%20%22public%22%0A%20%20%20%20%20%20%20%20%2F%20%22data%22%0A%20%20%20%20%20%20%20%20%2F%20%22detectA0%2Fexec_max_degree_5.npz%22%0A%20%20%20%20)%0A%0A%20%20%20%20with%20open_url(tm_path)%20as%20f%3A%0A%20%20%20%20%20%20%20%20tm_yaml%20%3D%20f.read()%0A%20%20%20%20%20%20%20%20tm_json%20%3D%20yaml.safe_load(tm_yaml)%0A%0A%0A%0A%20%20%20%20async%20def%20load_npz_from_url(url%3A%20str)%3A%0A%20%20%20%20%20%20%20%20resp%20%3D%20await%20pyfetch(url)%20%20%23%20HTTP%20GET%0A%20%20%20%20%20%20%20%20resp.raise_for_status()%20%20%23%20optional%0A%20%20%20%20%20%20%20%20buf%20%3D%20await%20resp.bytes()%20%20%23%20raw%20bytes%0A%20%20%20%20%20%20%20%20return%20np.load(io.BytesIO(buf))%0A%0A%0A%20%20%20%20geo_arrays%20%3D%20await%20load_npz_from_url(geo_path)%0A%20%20%20%20code_geo%20%3D%20CodeGeometry(%0A%20%20%20%20%20%20%20%20%20%20%20%20max_degree%3Dint(geo_arrays%5B%22max_degree%22%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20monomials%3Dgeo_arrays%5B%22monomials%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20error_counts%3Dgeo_arrays%5B%22error_counts%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20influences%3Dgeo_arrays%5B%22influences%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20derivatives_vec%3Dgeo_arrays%5B%22derivatives_vec%22%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%20code_geo%2C%20tm_json%2C%20tm_yaml%0A%0A%0A%40app.cell%0Adef%20_(code_geo%2C%20tm_yaml)%3A%0A%20%20%20%20from%20plainll.parse%20import%20parse_complete_tm%0A%20%20%20%20from%20scope.taylor%20import%20(%0A%20%20%20%20%20%20%20%20get_interesting_slices%2C%0A%20%20%20%20%20%20%20%20reduced_taylor_series_from_code_geometry%2C%0A%20%20%20%20)%0A%0A%20%20%20%20complete_tm%20%3D%20parse_complete_tm(tm_yaml)%0A%20%20%20%20inf_prob%20%3D%20complete_tm.inference_problem%0A%20%20%20%20code_name%20%3D%20complete_tm.name%0A%20%20%20%20model%20%3D%20complete_tm.model%0A%20%20%20%20code%20%3D%20complete_tm.code%0A%20%20%20%20error_spec%20%3D%20model.full_canonical_error_spec(code)%0A%20%20%20%20code_var_info%20%3D%20model.get_code_var_info(code%3Dcode%2C%20error_spec%3Derror_spec)%0A%0A%20%20%20%20full_taylor_series%20%3D%20reduced_taylor_series_from_code_geometry(code_geo%2C%20inf_prob)%0A%20%20%20%20num_vars%20%3D%20full_taylor_series.num_vars%0A%20%20%20%20full_poly_ascii%20%3D%20f%22%60%60%60%5Cn%7Bfull_taylor_series.poly_ascii(var_names%3D%5Bf'w%7Bi%7D'%20for%20i%20in%20range(1%2C%20num_vars%20%2B%201)%5D)%7D%5Cn%60%60%60%22%0A%20%20%20%20full_poly_latex%20%3D%20f%22%24%7Bfull_taylor_series.poly_latex(var_names%3D%5Bf'w_%7B%7B%7Bi%7D%7D%7D'%20for%20i%20in%20range(1%2C%20num_vars%20%2B%201)%5D)%7D%24%22%0A%0A%20%20%20%20pairs%20%3D%20get_interesting_slices(full_taylor_series%2C%20k%3D2)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20code_name%2C%0A%20%20%20%20%20%20%20%20code_var_info%2C%0A%20%20%20%20%20%20%20%20full_poly_ascii%2C%0A%20%20%20%20%20%20%20%20full_poly_latex%2C%0A%20%20%20%20%20%20%20%20full_taylor_series%2C%0A%20%20%20%20%20%20%20%20inf_prob%2C%0A%20%20%20%20%20%20%20%20model%2C%0A%20%20%20%20%20%20%20%20num_vars%2C%0A%20%20%20%20%20%20%20%20pairs%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(code_var_info%2C%20model)%3A%0A%20%20%20%20from%20plainll.tm%20import%20TMSquareVarInfo%0A%0A%20%20%20%20def%20format_square(square%3A%20TMSquareVarInfo%2C%20idxs)%3A%0A%20%20%20%20%20%20%20%20errs%20%3D%20%5Bvar%20for%20var%20in%20square.errors%20if%20var.var_idx%20in%20idxs%5D%0A%20%20%20%20%20%20%20%20if%20errs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22%20%22.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%5Bw%3Csub%3E%7Bvar.var_idx%7D%3C%2Fsub%3E%3A%7Bsquare.correct%7D%E2%86%92%7Bvar.error%7D%5D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20var%20in%20errs%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20square.correct%0A%0A%20%20%20%20def%20make_transitions_with_error_html(triple)%3A%0A%20%20%20%20%20%20%20%20html%20%3D%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20table%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border-collapse%3A%20collapse%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20auto%3B%20%2F*%20Change%20to%20auto%20to%20avoid%20full%20width%20stretching%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20'Courier%20New'%2C%20Courier%2C%20monospace%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%201.2em%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20th%2C%20td%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%201px%20solid%20%23000%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20padding%3A%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20th%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3A%2050px%3B%20%2F*%20Fixed%20width%20for%20State%20and%20Symbol%20columns%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2050px%3B%20%2F*%20Fixed%20height%20for%20State%20and%20Symbol%20columns%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20td%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20150px%3B%20%2F*%20Width%20for%20the%20Write%2C%20Move%2C%20and%20Next%20State%20columns%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3A%2050px%3B%20%2F*%20Fixed%20height%20for%20the%20Write%2C%20Move%2C%20and%20Next%20State%20columns%20*%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%3C%2Fstyle%3E%0A%20%20%20%20%20%20%20%20%3Ctable%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cth%3EState%3C%2Fth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cth%3ESymbol%3C%2Fth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cth%3EWrite%3C%2Fth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cth%3EMove%3C%2Fth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cth%3ENext%20State%3C%2Fth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Ftr%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20for%20(s%2C%20q)%2C%20write_square%2C%20state_square%2C%20dir_square%20in%20zip(%0A%20%20%20%20%20%20%20%20%20%20%20%20model.descr_pairs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.writes%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.states%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.dirs%2C%0A%20%20%20%20%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20write_content%20%3D%20format_square(write_square%2C%20triple)%0A%20%20%20%20%20%20%20%20%20%20%20%20state_content%20%3D%20format_square(state_square%2C%20triple)%0A%20%20%20%20%20%20%20%20%20%20%20%20dir_content%20%3D%20format_square(dir_square%2C%20triple)%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ctr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%3E%7Bs%7D%3C%2Ftd%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%3E%7Bq%7D%3C%2Ftd%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%3E%7Bwrite_content%7D%3C%2Ftd%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%3E%7Bstate_content%7D%3C%2Ftd%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctd%3E%7Bdir_content%7D%3C%2Ftd%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Ftr%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20html%20%2B%3D%20%22%22%22%0A%20%20%20%20%20%20%20%20%3C%2Ftable%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20return%20html%0A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(code_var_info%2C%20model)%3A%0A%20%20%20%20MAX_ERRORS%20%3D%202%0A%20%20%20%20ERROR_BOX_SIZE%20%3D%2034%0A%20%20%20%20CELL_SIZE%20%3D%2040%0A%20%20%20%20DEFAULT_FONT_SIZE%20%3D%2012%0A%20%20%20%20HEADER_FONT_SIZE%20%3D%2018%0A%20%20%20%20ERROR_BOX_BORDER_COLOR%20%3D%20%22%23f87171%22%0A%20%20%20%20ERROR_BOX_BACKGROUND_COLOR%20%3D%20%22%23fee2e2%22%0A%20%20%20%20TABLE_BACKGROUND_COLOR%20%3D%20%22%23FFFFFF%22%0A%20%20%20%20TABLE_BORDER_COLOR%20%3D%20%22%23000000%22%0A%20%20%20%20TEXT_COLOR%20%3D%20%22black%22%0A%20%20%20%20HEADER_FONT_FAMILY%20%3D%20%22'Courier%20New'%2C%20Courier%2C%20monospace%22%0A%0A%20%20%20%20def%20render_turing_table(pair%3DNone)%3A%0A%20%20%20%20%20%20%20%20%23%20Calculate%20output%20cell%20width%0A%20%20%20%20%20%20%20%20output_cell_width%20%3D%20(MAX_ERRORS%20*%20ERROR_BOX_SIZE)%20%2B%20CELL_SIZE%0A%0A%20%20%20%20%20%20%20%20headers%20%3D%20%5B%22Read%22%2C%20%22State%22%2C%20%22Write%22%2C%20%22Next%20State%22%2C%20%22Move%22%5D%0A%0A%20%20%20%20%20%20%20%20def%20render_cell(square)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Render%20a%20single%20cell%2C%20handling%20correct%20and%20error%20formats.%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20correct_value%20%3D%20square.correct%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Filter%20errors%20to%20only%20show%20those%20in%20the%20pair%0A%20%20%20%20%20%20%20%20%20%20%20%20filtered_errors%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20for%20var%20in%20square.errors%20if%20pair%20is%20not%20None%20and%20var.var_idx%20in%20pair%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20errors_html%20%3D%20%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20filtered_errors%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error_boxes%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20var%20in%20filtered_errors%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error_boxes.append(f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BERROR_BOX_SIZE%7Dpx%3B%20height%3A%20%7BERROR_BOX_SIZE%7Dpx%3B%20border%3A%201px%20solid%20%7BERROR_BOX_BORDER_COLOR%7D%3B%20border-radius%3A%204px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20%7BERROR_BOX_BACKGROUND_COLOR%7D%3B%20display%3A%20inline-flex%3B%20flex-direction%3A%20column%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20position%3A%20relative%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22position%3A%20absolute%3B%20top%3A%200%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-size%3A%209px%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line-height%3A%2010px%3B%20font-weight%3A%20normal%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bvar.var_idx%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%3E%7Bvar.error%7D%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20errors_html%20%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%20%7BTEXT_COLOR%7D%3B%20margin%3A%200%204px%3B%22%3E%E2%86%92%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22%22.join(error_boxes)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BERROR_BOX_SIZE%7Dpx%3B%20height%3A%20%7BERROR_BOX_SIZE%7Dpx%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20inline-flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background-color%3A%20transparent%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bcorrect_value%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Berrors_html%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20html%20%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20justify-content%3A%20center%3B%20align-items%3A%20center%3B%20padding%3A%2032px%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22position%3A%20relative%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C!--%20Headers%20--%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22position%3A%20absolute%3B%20top%3A%20-%7BCELL_SIZE%7Dpx%3B%20left%3A%200%3B%20display%3A%20flex%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BCELL_SIZE%7Dpx%3B%20text-align%3A%20center%3B%20font-size%3A%20%7BDEFAULT_FONT_SIZE%7Dpx%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-family%3A%20monospace%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bheaders%5B0%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BCELL_SIZE%7Dpx%3B%20text-align%3A%20center%3B%20font-size%3A%20%7BDEFAULT_FONT_SIZE%7Dpx%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-family%3A%20monospace%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bheaders%5B1%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7Boutput_cell_width%7Dpx%3B%20text-align%3A%20center%3B%20font-size%3A%20%7BDEFAULT_FONT_SIZE%7Dpx%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-family%3A%20monospace%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bheaders%5B2%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7Boutput_cell_width%7Dpx%3B%20text-align%3A%20center%3B%20font-size%3A%20%7BDEFAULT_FONT_SIZE%7Dpx%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-family%3A%20monospace%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bheaders%5B3%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7Boutput_cell_width%7Dpx%3B%20text-align%3A%20center%3B%20font-size%3A%20%7BDEFAULT_FONT_SIZE%7Dpx%3B%20color%3A%20%7BTEXT_COLOR%7D%3B%20font-family%3A%20monospace%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bheaders%5B4%5D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C!--%20Table%20--%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22border%3A%202px%20solid%20%7BTABLE_BORDER_COLOR%7D%3B%20border-radius%3A%208px%3B%20overflow%3A%20hidden%3B%20background-color%3A%20%7BTABLE_BACKGROUND_COLOR%7D%3B%22%3E%20%20%3C!--%20Added%20background%20color%20--%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20rows%0A%20%20%20%20%20%20%20%20for%20(s%2C%20q)%2C%20write_square%2C%20state_square%2C%20dir_square%20in%20zip(%0A%20%20%20%20%20%20%20%20%20%20%20%20model.descr_pairs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.writes%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.states%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20code_var_info.dirs%2C%0A%20%20%20%20%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20'%3Cdiv%20style%3D%22display%3A%20flex%3B%20border-bottom%3A%200.5px%20solid%20%7BTABLE_BORDER_COLOR%7D%3B%22%3E'%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20State%20cell%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BCELL_SIZE%7Dpx%3B%20height%3A%20%7BCELL_SIZE%7Dpx%3B%20border%3A%200.5px%20solid%20%7BTABLE_BORDER_COLOR%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20inline-flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20%7BHEADER_FONT_FAMILY%7D%3B%20font-weight%3A%20bold%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%20%7BHEADER_FONT_SIZE%7Dpx%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bs%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Read%20cell%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7BCELL_SIZE%7Dpx%3B%20height%3A%20%7BCELL_SIZE%7Dpx%3B%20border%3A%200.5px%20solid%20%7BTABLE_BORDER_COLOR%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20inline-flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20%7BHEADER_FONT_FAMILY%7D%3B%20font-weight%3A%20bold%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%20%7BHEADER_FONT_SIZE%7Dpx%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bq%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Output%20cells%20(Write%2C%20State%2C%20Move)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20square%20in%20%5Bwrite_square%2C%20state_square%2C%20dir_square%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22width%3A%20%7Boutput_cell_width%7Dpx%3B%20height%3A%20%7BCELL_SIZE%7Dpx%3B%20border%3A%200.5px%20solid%20%7BTABLE_BORDER_COLOR%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20display%3A%20inline-flex%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-family%3A%20%7BHEADER_FONT_FAMILY%7D%3B%20font-weight%3A%20bold%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font-size%3A%20%7BHEADER_FONT_SIZE%7Dpx%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Brender_cell(square)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20html%20%2B%3D%20%22%3C%2Fdiv%3E%22%0A%0A%20%20%20%20%20%20%20%20html%20%2B%3D%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20return%20html%0A%0A%20%20%20%20return%20(render_turing_table%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20scope.poly%20import%20sympy_poly_from_taylor_series%0A%0A%20%20%20%20def%20get_factored(ts)%3A%0A%20%20%20%20%20%20%20%20poly%20%3D%20sympy_poly_from_taylor_series(ts)%0A%20%20%20%20%20%20%20%20poly_exp%20%3D%20poly.as_expr()%0A%20%20%20%20%20%20%20%20factored%20%3D%20sp.factor(poly_exp)%0A%20%20%20%20%20%20%20%20if%20factored%20%3D%3D%20poly_exp%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20factored%0A%0A%20%20%20%20return%20(get_factored%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20The%20Geometry%20of%20Noisy%20Turing%20Machines%0A%0A%20%20%20%20A%20function%20%24f%20%3A%20X%20%5Cto%20Y%24%20which%20is%20*computable*%20may%20have%20many%20implementations.%20That%20is%2C%20in%20a%20given%20a%20model%20of%20computation%20such%20as%20Turing%20machines%2C%20the%20lambda%20calculus%2C%20Python%20etc%2C%20there%20may%20be%20two%20machines%2Flambda-terms%2Fprograms%20%24F%24%20and%20%24G%24%2C%20such%20that%20%24F(x)%20%3D%20f(x)%20%3D%20G(x)%24%20for%20all%20%24x%20%5Cin%20X%24%2C%20yet%20the%20algorithms%20implemented%20by%20%24F%24%20and%20%24G%24%20are%20different%20in%20some%20essential%20way.%20For%20example%2C%20take%20the%20following%20instance%0A%0A%20%20%20%20-%20%24X%24%20consists%20of%20pairs%20%24(x%2CL)%24%2C%20where%20%24x%24%20is%20an%20integer%20and%20%24L%24%20is%20a%20finite%20*sorted*%20list%20of%20integers%0A%20%20%20%20-%20%24Y%3D%5C%7B%7B0%2C1%5C%7D%7D%24%0A%20%20%20%20-%20%24f(x%2CL)%20%3D%201%24%20if%20and%20only%20if%20%24x%20%5Cin%20L%24%0A%0A%20%20%20%20For%20a%20given%20model%20of%20computation%2C%20we%20could%20implement%20a%20program%20computing%20%24f%24%20using%20a%20linear%20scan%20algorithm%20for%20%24F%24%20and%20a%20binary%20search%20algorithm%20for%20%24G%24%2C%20and%20these%20would%20yield%20the%20same%20outputs%20on%20all%20inputs%20%24(x%2CL)%24%2C%20yet%20the%20actual%20computational%20process%20carried%20out%20by%20these%20programs%20are%20very%20different.%20This%20difference%20may%20be%20apparent%20in%20explicit%20structural%20features%20of%20the%20source%20code%2C%20i.e.%20%24F%24%20contains%20a%20while%20loop%20while%20%24G%24%20uses%20if-else%20control%20flow%20and%20recursion%2C%20but%20there%20are%20also%20consequential%20features%20such%20as%20run-time%2C%20memory%20usage%20or%20robustness%20to%20errors%20in%20execution.%20These%20are%20features%20of%20the%20%22runtime%20trajectory%22%2C%20that%20is%2C%20the%20sequence%20of%20configurations%20that%20a%20computing%20device%20enters%20over%20time%20as%20it%20is%20executing%20a%20program.%0A%0A%20%20%20%20We%20present%20a%20setting%20in%20which%20we%20can%20study%20programs%20as%20critical%20points%20of%20a%20smooth%20analytic%20function%2C%20such%20that%20the%20local%20geometry%20encodes%20information%20about%20the%20program's%20runtime-trajectories.%20This%20work%20is%20based%20on%20%5BPrograms%20as%20Singularities%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2504.08075)%20(%3Ca%20href%3D%22%23ref-1%22%3E%5B1%5D%3C%2Fa%3E%20Murfet%2C%20Troiani)%2C%20and%20the%20primary%20contribution%20is%20automating%20the%20explicit%20calculation%20of%20relevant%20polynomial%20coefficients%20that%20determine%20this%20geometry%2C%20and%20empirically%20identifying%20connections%20between%20geometric%20and%20algorithmic%20structure.%0A%0A%20%20%20%20%23%23%20Learning%20theory%2C%20geometry%20and%20algorithms%0A%0A%20%20%20%20The%20problem%20of%20*program%20synthesis*%20is%20to%20find%20a%20program%20that%20computes%20a%20given%20function%20presented%20by%20its%20graph%20%24%5C%7B(x%2Cf(x))%5C%7D_%7Bx%20%5Cin%20X%7D%24.%20We%20must%20choose%20a%20model%20of%20computation%20%24(E%2CA)%24%2C%20which%20consists%20of%20a%20program%20executor%20%24E%24%20and%20a%20space%20of%20programs%20%24A%24%20(i.e.%20the%20source%20code).%20Typical%20deterministic%20models%20of%20computation%20yield%20a%20discrete%20space%20of%20programs%2C%20upon%20which%20the%20only%20natural%20learning%20process%20is%20brute-force%20evaluation%2C%20treating%20each%20%24P%20%5Cin%20A%24%20as%20a%20black%20box%20function.%20We%20seek%20a%20setting%20in%20which%20features%20of%20the%20runtime%20trajectory%20of%20a%20program%20on%20a%20given%20input%20is%20present%20in%20the%20geometry%20of%20%24A%24%2C%20specifically%20the%20local%20geometry%20of%20%24E%24%20around%20%24P%20%5Cin%20A%24.%0A%0A%20%20%20%20In%20deep%20learning%20models%20such%20as%20transformers%2C%20the%20goal%20of%20the%20learning%20process%20is%20to%20minimise%20a%20%22loss%20function%22%2C%20a%20smooth%20analytic%20function%20on%20the%20parameter%20space%20%24W%24%20of%20weights.%20Singular%20learning%20theory%20proves%20that%20such%20a%20learning%20process%20is%20in%20part%20determined%20by%20the%20structure%20of%20the%20singularities%20that%20arise%20at%20critical%20points%20of%20this%20loss%20function.%20Moreover%2C%20there%20is%20empirical%20evidence%20in%20deep%20learning%20that%20transformer%20models%20implement%20%22circuits%22%20and%20exhibit%20preferences%20for%20different%20kinds%20of%20circuits%20during%20the%20learning%20process.%20The%20perspective%20of%20%22Structural%20Bayesianism%22%20put%20forward%20in%20Murfet%2C%20Troiani%2C%20is%20that%20the%20learning%20process%20(for%20noisy%20TMs%2C%20perhaps%20also%20transformers)%20selects%20for%20certain%20kinds%20of%20algorithmic%20structure%20via%20the%20geometry.%0A%0A%20%20%20%20%23%23%20Noisy%20Turing%20machines%0A%0A%20%20%20%20For%20our%20model%20of%20computation%2C%20we%20extend%20the%20notion%20of%20Turing%20machine%20to%20allow%20for%20uncertainty%20in%20individual%20outputs%20of%20the%20transition%20function.%20A%20full%20account%20is%20given%20in%20section%205%20of%20%5BPrograms%20as%20Singularities%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2504.08075)%2C%20but%20we%20will%20give%20a%20summary%20of%20the%20components%20involved.%0A%0A%20%20%20%20%3E%20This%20is%20just%20a%20notational%20review%20of%20a%20Turing%20machines.%20Not%20intended%20to%20explain%20the%20concept%0A%0A%20%20%20%20Fix%20some%20finite%20alphabet%20%24%5CSigma%24%20of%20symbols%20(including%20a%20designated%20blank%20symbol)%20and%20a%20finite%20set%20of%20states%20%24Q%24.%20A%20Turing%20machine%20is%20an%20element%20of%20the%20product%0A%0A%20%20%20%20%24%24W%5E%7B%5Ctexttt%7Bcode%7D%7D%20%3D%20%5Cprod_%7B%7B%5Csigma%2C%20q%7D%7D%20%5CSigma%20%5Ctimes%20Q%20%5Ctimes%20%5C%7B%7B%5Ctexttt%7B%7BL%7D%7D%2C%20%5Ctexttt%7B%7BS%7D%7D%2C%20%5Ctexttt%7B%7BR%7D%7D%5C%7D%7D%24%24%0A%0A%20%20%20%20i.e.%20a%20function%20%24%5Cdelta%24%20assigning%20to%20each%20pair%20of%20a%20symbol%20%24%5Csigma%24%20and%20state%20%24q%24%2C%20a%20triple%20%24%5Cdelta(s%2Cq)%20%3D%20(s'%2Cq'%2Cd)%24%2C%20where%20%24s'%24%20is%20the%20symbol%20to%20write%20on%20the%20tape%2C%20%24q'%24%20is%20the%20state%20to%20transition%20to%20and%20%24d%24%20is%20the%20direction%20to%20move%20the%20tapehead%20(left%2C%20stay%20or%20right).%0A%0A%20%20%20%20A%20*noisy*%20Turing%20machine%20allows%20for%20uncertainty%20in%20the%20symbol%20to%20write%2C%20the%20state%20to%20transition%20to%20and%20the%20direction%20to%20move.%20The%20space%20of%20noisy%20Turing%20machines%20is%20the%20following%20manifold%20with%20corners%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20W%20%3D%20%5Cprod_%7B%7B%5Csigma%2C%20q%7D%7D%20%5CDelta%20%5CSigma%20%5Ctimes%20%5CDelta%20Q%20%5Ctimes%20%5CDelta%20%5C%7B%7B%5Ctexttt%7B%7BL%7D%7D%2C%20%5Ctexttt%7B%7BS%7D%7D%2C%20%5Ctexttt%7B%7BR%7D%7D%5C%7D%7D%2C%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20where%20%24%5CDelta%20Z%20%3D%20%5C%7B%7B%5Ctext%7B%7Bprobability%20distributions%20over%20%7D%7D%20Z%5C%7D%7D%20%3D%20%5C%7B%7Bf%20%3A%20Z%20%5Cto%20%5B0%2C1%5D%20%5Cmid%20%5Csum_%7B%7Bz%20%5Cin%20Z%7D%7D%20f(z)%20%3D%201%5C%7D%7D%24%20is%20an%20%24n%24-simplex%20sitting%20inside%20the%20vector%20space%20%24%5Cmathbb%7BR%7DZ%24%20(where%20%24n%3D%7CZ%7C-1%24).%0A%0A%20%20%20%20%23%23%20Noisy%20TM%20Execution%0A%0A%20%20%20%20In%20%3Ca%20href%3D%22%23ref-1%22%3E%5B1%5D%3C%2Fa%3E%2C%20the%20code%20of%20a%20noisy%20Turing%20machine%20is%20written%20to%20the%20description%20tape%20of%20a%20multi-tape%20UTM%2C%20and%20the%20execution%20behaviour%20is%20such%20that%20whenever%20a%20description%20tape-square%20is%20read%2C%20an%20independent%20sample%20of%20the%20corresponding%20probability%20distribution%20is%20taken.%20Prototypically%20there%20is%20a%20correct%20value%20%24x%24%2C%20an%20error%20value%20%24e%24%20and%20we%20consider%20a%20small%20probability%20%24%5Cvarepsilon%24%20of%20reading%20%24e%24%20instead%20of%20%24x%24.%20This%20propogates%20uncertainty%20onto%20the%20%22working%20tape%22%20of%20the%20simulated%20machine%2C%20and%20its%20final%20state%20is%20a%20random%20variable%20%24Y%24%2C%20and%20%24P(Y%3Dy)%24%20can%20be%20described%20as%20a%20polynomial%20in%20%24%5Cvarepsilon%24.%20Importantly%2C%20this%20random%20variable%20is%20sensitive%20to%20the%20runtime%20trajectory%20of%20the%20Turing%20machine%2C%20not%20just%20the%20function%20it%20computes.%0A%0A%20%20%20%20Section%206%20of%20%3Ca%20href%3D%22%23ref-1%22%3E%5B1%5D%3C%2Fa%3E%20proves%20that%20the%20degree-n%20coefficients%20of%20this%20polynomial%20are%20determined%20by%20how%20many%20ways%20in%20which%20%24%5Cleq%20n%24%20errors%20during%20execution%20can%20cause%20the%20final%20state%20to%20be%20%24y%24.%20In%20fact%2C%20this%20matches%20the%20meaning%20of%20%22derivative%20of%20a%20program%22%20given%20by%20the%20Erhard%20and%20Regnier%20in%20%3Ca%20href%3D%22%23ref-2%22%3E%5B2%5D%3C%2Fa%3E.%20This%20connection%20is%20formally%20established%20in%20%3Ca%20href%3D%22%23ref-3%22%3E%5B3%5D%3C%2Fa%3E%2C%20where%20the%20execution%20of%20the%20UTM%20is%20encoded%20in%20differential%20linear%20logic.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20The%20Polynomial%20H%20associated%20to%20a%20Turing%20machine%0A%0A%20%20%20%20%3E%20Note%20to%20reader%3A%20This%20section%20is%20quite%20terse%20right%20now%20and%20refers%20to%20details%20found%20in%20%5BPrograms%20as%20Singularities%5D(https%3A%2F%2Farxiv.org%2Fabs%2F2504.08075).%20It%20should%20probably%20be%20rewritten.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Expand%20for%20details%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Let%20%24%5CSigma%24%20be%20a%20finite%20set%20of%20symbols%20(including%20a%20designated%20blank%20symbol)%2C%20%24Q%24%20a%20finite%20set%20of%20states%20and%20consider%20a%20computable%20function%20%24y%20%3D%20y(x)%20%5Cin%20Q%24%20for%20%24x%20%5Cin%20%5CSigma%5E*%24%20(non-empty).%0A%0A%20%20%20%20Given%20a%20finitely%20supported%20distribution%20%24q(x)%24%20over%20inputs%2C%20we%20derive%20a%20true%20distribution%20%24q(x%2Cy)%20%3D%20q(x)q(y%7Cx)%24%2C%20where%20%24q(y%7Cx)%20%3D%20%5Cdelta_%7B%7By%20%3D%20y(x)%7D%7D%24.%20We%20seek%20to%20model%20this%20distribution%20using%20the%20parameter%20space%20of%20noisy%20Turing%20machines%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20W%20%3D%20%5Cprod_%7B%7B%5Csigma%2C%20q%7D%7D%20%5CDelta%20%5CSigma%20%5Ctimes%20%5CDelta%20Q%20%5Ctimes%20%5CDelta%20%5C%7B%7B%5Ctexttt%7B%7BL%7D%7D%2C%20%5Ctexttt%7B%7BS%7D%7D%2C%20%5Ctexttt%7B%7BR%7D%7D%5C%7D%7D%2C%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20(where%20%24%5CDelta%20Z%20%3D%20%5C%7B%7B%5Ctext%7B%7Bprobability%20distributions%20over%20%7D%7D%20Z%5C%7D%7D%24)%20and%20the%20predictive%20distribution%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20p(y%7Cx%2Cw)%20%3D%20%5CDelta%5Cmathrm%7B%7Bstep%7D%7D%5Et(x%2Cw)_y%2C%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20where%20%24%5CDelta%5Cmathrm%7B%7Bstep%7D%7D%5Et(x%2Cw)%20%3A%20%5CSigma%5E*%20%5Ctimes%20W%20%5Cto%20%5CDelta%20Q%24%20is%20the%20smooth%20relaxation%20of%20the%20iterated%20UTM%20step%20function%20and%20%24t%24%20is%20fixed.%20Amongst%20the%20subset%20of%20deterministic%20Turing%20machines%20codes%0A%0A%20%20%20%20%5C%5BW%5E%7B%7B%5Ctexttt%7B%7Bcode%7D%7D%7D%7D%5Cprod_%7B%7B%5Csigma%2C%20q%7D%7D%20%5CSigma%20%5Ctimes%20Q%20%5Ctimes%20%5C%7B%7B%5Ctexttt%7B%7BL%7D%7D%2C%20%5Ctexttt%7B%7BS%7D%7D%2C%20%5Ctexttt%7B%7BR%7D%7D%5C%7D%7D%2C%5C%5D%0A%0A%20%20%20%20we%20seek%20a%20code%20%24%5BM%5D%20%5Cin%20W%5E%7B%7B%5Ctexttt%7B%7Bcode%7D%7D%7D%7D%24%20which%20is%20a%20solution%20to%20the%20synthesis%20problem%2C%20in%20the%20sense%20that%20%24M(x)%20%3D%20y(x)%24%20for%20all%20%24q(x)%20%3E%200%24.%0A%0A%20%20%20%20The%20*average%20negative%20log-likelihood*%20of%20a%20candidate%20%24w%20%5Cin%20W%24%20is%20given%20by%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20L(w)%20%3D%20-%5Csum_%7B%7Bx%20%5Cin%20%5CSigma%5E*%7D%7D%20q(x)%20%5Csum_%7B%7By%20%5Cin%20Q%7D%7Dq(y%7Cx)%5Clog%20p(y%20%5Cmid%20x%2Cw)%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20and%20this%20is%20comparable%20up%20to%20a%20constant%20to%20the%20function%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20H(w)%20%3D%20%5Csum_%7B%7Bx%20%5Cin%20%5CSigma%5E*%7D%7D%20q(x)p(y%20%5Cneq%20y(x)%20%5Cmid%20x%2Cw)%5E2%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20We%20study%20the%20geometry%20of%20%24H%24%20around%20solutions%20%24%5BM%5D%20%5Cin%20W%5E%7B%7B%5Ctexttt%7B%7Bcode%7D%7D%7D%7D%20%5Csubseteq%20W%24%20(which%20are%20critical%20points%20of%20%24H%24)%20by%20explicit%20calculation%20of%20the%20Taylor%20series%20centered%20at%20%24%5BM%5D%24.%20Due%20to%20combinatorial%20explosion%2C%20it%20is%20necessary%20to%20truncate%20at%20some%20maximum%20degree%20%24T%24.%20We%20use%20local%20coordinates%20%24w_i%24%20each%20corresponding%20to%20increasing%20the%20probability%20of%20error%20of%20a%20certain%20type%20on%20a%20given%20square%20of%20the%20code%20%24%5BM%5D%24.%0A%0A%20%20%20%20Fixing%20%24%5BM%5D%24%2C%20let%0A%0A%20%20%20%20%5C%5BH_%7B%7Bi%2Cj%7D%7D(x%2Cy)%20%3D%20C%20%5Ccdot%20H(w)%5Cvert_%7B%7Bw_i%3Dx%2Cw_j%3Dy%2C%20w_%5Csquare%20%3D%200%7D%7D%5C%5D%0A%0A%20%20%20%20be%20the%20restriction%20of%20H%20to%20two%20of%20the%20local%20coordinates%2C%20such%20that%20all%20other%20coordinates%20%24w_%5Csquare%20%3D%200%24%20for%20%24%5Csquare%20%5Cnot%5Cin%20%5C%7B%7Bi%2Cj%2Ck%5C%7D%7D%24.%20Here%20%24C%20%3D%20%5Csum_%7B%7Bx%7D%7D%20c(x)%24%2C%20where%20%24q(x)%24%20is%20assumed%20to%20have%20the%20form%20%24q(x)%20%3D%20%5Cfrac%7B%7Bc(x)%7D%7D%7B%7BC%7D%7D%24%20for%20integers%20%24c(x)%20%5Cin%20%5Cmathbb%7B%7BN%7D%7D_%7B%7B%5Cgeq%200%7D%7D%24.%20This%20ensures%20%24H_%7B%7Bi%2Cj%2Ck%7D%7D%24%20is%20a%20polynomial%20in%20integer%20coefficients%2C%20since%20%24p(y%20%5Cneq%20y(x)%20%5Cmid%20x%2Cw)%24%20is%20known%20to%20have%20only%20integer%20coefficients.%0A%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(inf_prob%2C%20tm_json)%3A%0A%20%20%20%20dist_description%20%3D%20(%0A%20%20%20%20%20%20%20%20f%22%24q(x)%24%20is%20uniform%20over%20%24%7Bmonospace_set(inf_prob.inputs)%7D%24%20(i.e.%20%24c(x)%20%3D%201%24%20on%20those%20inputs%20and%200%20otherwise)%22%0A%20%20%20%20%20%20%20%20if%20(inf_prob.counts%20%3D%3D%201).all()%0A%20%20%20%20%20%20%20%20else%20r%22%24q(x)%20%3D%20%5Cfrac%7Bc(x)%7D%7B%5Csum%20c(x)%7D%24%2C%20where%20%24%22%0A%20%20%20%20%20%20%20%20%2B%20%22%2C%22.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20rf%22c(%5Ctexttt%7B%7B%7Bx%7D%7D%7D)%20%3D%20%7Bc%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20x%2C%20c%20in%20zip(inf_prob.inputs%2C%20inf_prob.counts)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%2B%20%22%24%22%0A%20%20%20%20)%0A%0A%20%20%20%20if%20%22description%22%20in%20tm_json%5B%22inference_problem%22%5D%3A%0A%20%20%20%20%20%20%20%20inf_prob_description%20%3D%20r%22%24y(x)%24%20characterises%20the%20language%20of%20strings%20containing%20an%20%24%5Ctexttt%7BA%7D%24%2C%20i.e.%2C%20%24y(x)%20%3D%20%5Ctexttt%7Ba%7D%20%5CLeftrightarrow%20%20x%20%5Ctext%7B%20contains%20an%20%7D%20%5Ctexttt%7BA%7D%24%22%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20inf_prob_description%20%3D%20%22y(x)%20takes%20the%20following%20values%20on%20the%20support%20of%20q(x).%22%0A%0A%20%20%20%20mapping%20%3D%20%22%2C%22.join(%0A%20%20%20%20%20%20%20%20rf%22%5Ctexttt%7B%7B%7Bx%7D%7D%7D%20%5Cmapsto%20%5Ctexttt%7B%7B%7By%7D%7D%7D%22%0A%20%20%20%20%20%20%20%20for%20x%2C%20y%20in%20zip(inf_prob.inputs%2C%20inf_prob.outputs)%0A%20%20%20%20)%0A%0A%20%20%20%20inf_prob_description%20%2B%3D%20rf%22%22%22%0A%0A%20%20%20%20%5C%5B%5C%7B%7B%7Bmapping%7D%5C%7D%7D%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20return%20dist_description%2C%20inf_prob_description%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20code_geo%2C%0A%20%20%20%20code_name%2C%0A%20%20%20%20dist_description%2C%0A%20%20%20%20inf_prob_description%2C%0A%20%20%20%20model%2C%0A%20%20%20%20num_vars%2C%0A%20%20%20%20render_turing_table%2C%0A)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20rf%22%22%22%0A%20%20%20%20%23%23%20Example%20-%20%7Bcode_name%7D%0A%20%20%20%20In%20this%20example%2C%20we%20have%20the%20following%20choices%0A%0A%20%20%20%20-%20%24%5CSigma%20%3D%20%7Bmonospace_set(model.alphabet)%7D%24%0A%20%20%20%20-%20%24Q%20%3D%20%7Bmonospace_set(model.states)%7D%24%0A%20%20%20%20-%20%7Bdist_description%7D%0A%20%20%20%20-%20%7Binf_prob_description%7D%0A%20%20%20%20-%20%24t%3D2%24%20(number%20of%20iterations%20of%20the%20TM)%0A%20%20%20%20-%20%24T%20%3D%20%7Bcode_geo.max_degree%7D%24%20(we%20compute%20a%20truncation%20of%20the%20taylor%20series%20up%20to%20max%20total%20degree%20%7Bcode_geo.max_degree%7D)%0A%0A%20%20%20%20We%20fix%20a%20solution%20Turing%20machine%20%24M%24%2C%20in%20this%20case%20one%20called%20%60%7Bcode_name%7D%60%2C%20with%20the%20following%20transition%20table.%0A%20%20%20%20%7Bmo.Html(render_turing_table())%7D%0A%0A%20%20%20%20We%20compute%20the%20Taylor%20expansion%20centered%20at%20the%20code%20%24%5BM%5D%24%2C%20truncated%20to%20a%20maximum%20total%20degree%20of%20%24K%20%3D%20%7Bcode_geo.max_degree%7D%24%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20H%20%5Capprox%20%5Csum_%7B%7B%5Clvert%5Cmathbf%7B%7Bk%7D%7D%5Crvert%20%5Cleq%20%7Bcode_geo.max_degree%7D%7D%7D%20%5Cfrac%7B%7B1%7D%7D%7B%7B%5Cmathbf%7B%7Bk%7D%7D!%7D%7D%20%5Cleft.%5Cfrac%7B%7B%5Cpartial%5E%7B%7Bk%7D%7D%20H%20%7D%7D%7B%7B%5Cpartial%20w_%7B%7B1%7D%7D%5E%7B%7Bk_1%7D%7D%20%5Ccdots%20%5Cpartial%20w_%7B%7B%7Bnum_vars%7D%7D%7D%5E%7B%7Bk_%7B%7B%7Bnum_vars%7D%7D%7D%7D%7D%7D%7D%20%5Cright%5Cvert_%7B%7Bw%3D%5BM%5D%7D%7D%20%5Ccdot%20w_%7B%7B1%7D%7D%5E%7B%7Bk_1%7D%7D%20%5Ccdots%20w_%7B%7B%7Bnum_vars%7D%7D%7D%5E%7B%7Bk_%7B%7B%7Bnum_vars%7D%7D%7D%7D%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20This%20calculation%20is%20done%20by%20explicitly%20running%20the%20UTM%20against%20the%20code%20under%20all%20possible%20*error%20syndromes*%20with%20at%20most%20%7Bcode_geo.max_degree%7D%20errors%20of%20any%20kind%2C%20and%20using%20the%20results%20of%20section%206%20in%20%3Ca%20href%3D%22%23ref-1%22%3E%5B1%5D%3C%2Fa%3E%20to%20compute%20the%20partial%20derivatives%20of%20%24H%24.%0A%0A%20%20%20%20Here%20is%20the%20entire%20polynomial%20(click%20to%20open)%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(full_poly_ascii%2C%20full_poly_latex)%3A%0A%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22ASCII%22%3A%20full_poly_ascii%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22LaTeX%22%3A%20full_poly_latex%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Restricting%20H(w)%20to%202D%20slices%20of%20W%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22To%20better%20understand%20the%20singularity%20at%20%24%5BM%5D%24%2C%20we%20restrict%20our%20attention%20to%202%20variables%2C%20%24w_i%2Cw_j%24%20for%20some%20choice%20of%20%24(i%2Cj)%24%2C%20and%20set%20all%20others%20to%20%240%24%20(we%20also%20multiply%20by%20%24C%24%20-%20see%20Background).%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pairs)%3A%0A%20%20%20%20pair_dropdown%20%3D%20mo.ui.dropdown(pairs%2C%20value%3Dpairs%5B0%5D)%0A%20%20%20%20return%20(pair_dropdown%2C)%0A%0A%0A%40app.cell%0Adef%20_(pair_dropdown)%3A%0A%20%20%20%20chosen_pair%20%3D%20pair_dropdown.value%0A%20%20%20%20i%2C%20j%20%3D%20chosen_pair%0A%20%20%20%20return%20chosen_pair%2C%20i%2C%20j%0A%0A%0A%40app.cell%0Adef%20_(code_var_info%2C%20i%2C%20j%2C%20pair_dropdown)%3A%0A%20%20%20%20def%20describe_var(idx%3A%20int)%3A%0A%20%20%20%20%20%20%20%20var_idx_info%20%3D%20code_var_info.vars%5Bidx%5D%0A%20%20%20%20%20%20%20%20if%20var_idx_info.output_kind%20%3D%3D%20%22write%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mistake%20%3D%20rf%22writing%20symbol%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.error%7D%7D%7D%24%20instead%20of%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.correct%7D%7D%7D%24%22%0A%20%20%20%20%20%20%20%20elif%20var_idx_info.output_kind%20%3D%3D%20%22next_state%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mistake%20%3D%20rf%22transitioning%20to%20state%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.error%7D%7D%7D%24%20instead%20of%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.correct%7D%7D%7D%24%22%0A%20%20%20%20%20%20%20%20elif%20var_idx_info.output_kind%20%3D%3D%20%22dir%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20action_map%20%3D%20%7B%22L%22%3A%20%22moving%20left%22%2C%20%22S%22%3A%20%22not%20moving%22%2C%20%22R%22%3A%20%22moving%20right%22%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20mistake%20%3D%20rf%22%7Baction_map%5Bvar_idx_info.error%5D%7D%20instead%20of%20%7Baction_map%5Bvar_idx_info.correct%5D%7D%22%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20assert%20False%0A%0A%20%20%20%20%20%20%20%20return%20rf%22The%20probability%20of%20%7Bmistake%7D%20when%20reading%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.read%7D%7D%7D%24%20in%20state%20%24%5Ctexttt%7B%7B%7Bvar_idx_info.state%7D%7D%7D%24%22.replace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22_%22%2C%20r%22%5C_%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20rf%22%22%22%0A%20%20%20%20%24(i%2Cj)%20%3D%24%20%7Bpair_dropdown%7D%0A%0A%0A%0A%20%20%20%20We%20inspect%20the%20neighbourhood%20around%20%24%5BM%5D%24%20in%20the%20coordinates%20%24w_%7B%7B%7Bi%7D%7D%7D%2C%20w_%7B%7B%7Bj%7D%7D%7D%24.%20These%20have%20the%20following%20meaning.%0A%0A%20%20%20%20-%20%24w_%7B%7B%7Bi%7D%7D%7D%24%3A%20%7Bdescribe_var(i)%7D%0A%20%20%20%20-%20%24w_%7B%7B%7Bj%7D%7D%7D%24%3A%20%7Bdescribe_var(j)%7D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(chosen_pair%2C%20code_geo%2C%20full_taylor_series%2C%20i%2C%20j)%3A%0A%20%20%20%20chosen_slice%20%3D%20full_taylor_series.slice(chosen_pair)%0A%0A%20%20%20%20mo.md(f%22%22%22%0A%20%20%20%20In%20these%20coordinates%2C%20%24H(w)%24%20is%20given%20by%20the%20following%20polynomial%20(truncated%20to%20maximum%20degree%20%7Bcode_geo.max_degree%7D%20terms)%0A%0A%20%20%20%20%5C%5BH_%7B%7B%7Bi%7D%2C%7Bj%7D%7D%7D(x%2Cy)%20%3D%20%7Bchosen_slice.poly_latex()%7D%5C%5D%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%20(chosen_slice%2C)%0A%0A%0A%40app.cell%0Adef%20_(chosen_slice)%3A%0A%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22ASCII%22%3A%20mo.md(rf%22%22%22%0A%20%20%20%20%60%60%60%0A%20%20%20%20%7Bchosen_slice.poly_ascii()%7D%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22Here%20we%20illustrate%20the%20location%20and%20type%20of%20errors%20on%20the%20transition%20table%20of%20%24M%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(chosen_pair%2C%20render_turing_table)%3A%0A%20%20%20%20mo.center(mo.Html(render_turing_table(chosen_pair)))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20All%20nontrivial%20slices%0A%0A%20%20%20%20Below%20is%20a%20table%20of%20every%20nontrivial%20slice%20of%20%24H(w)%24%2C%20that%20is%2C%20pairs%20%24(i%2Cj)%24%20such%20that%20%24H_%7Bi%2Cj%7D(x%2Cy)%24%20is%20a%20polynomial%20in%20which%20both%20%24x%24%20and%20%24y%24%20appear%20(possibly%20in%20different%20terms).%20This%20filters%20out%20single%20variable%20polynomials%20and%20zero%20polynomials.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(r%22%22%22**Selected%20rows%20are%20rendered%20as%20contour%20plots%20below**%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(full_taylor_series%2C%20get_factored%2C%20pairs)%3A%0A%20%20%20%20slices%20%3D%20%5Bfull_taylor_series.slice(pair)%20for%20pair%20in%20pairs%5D%0A%0A%20%20%20%20pair_table%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22(i%2Cj)%22%3A%20pair%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Hij(x%2Cy)%22%3A%20slice%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Factorisation%22%3A%20get_factored(slice)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20pair%2C%20slice%20in%20zip(pairs%2C%20slices)%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20format_mapping%3D%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Hij(x%2Cy)%22%3A%20lambda%20slice%3A%20mo.md(f%22%24%7Bslice.poly_latex()%7D%24%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Factorisation%22%3A%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20f%3A%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22(irreducible)%22%20if%20f%20is%20None%20else%20mo.md(sp.latex(f%2C%20mode%3D%22inline%22))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20initial_selection%3Drange(len(pairs))%2C%0A%20%20%20%20%20%20%20%20page_size%3Dlen(pairs)%2C%0A%20%20%20%20)%0A%20%20%20%20pair_table%0A%20%20%20%20return%20(pair_table%2C)%0A%0A%0A%40app.cell%0Adef%20_(z_max)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20rf%22%22%22%0A%20%20%20%20%23%23%20Contour%20Plots%0A%0A%20%20%20%20We%20plot%20filled%20contours%20of%20H%20on%20planar%20slices%20of%20%24W%24.%0A%0A%20%20%20%20Specifically%2C%20for%20a%20pair%20of%20local%20coordinates%20%24w_i%2C%20w_j%24%20(selectable%20in%20the%20table%20above)%20we%20plot%20a%20color%20gradient%20of%20values%20for%20%240%20%5Cleq%20H_%7B%7Bi%2Cj%7D%7D(x%2Cy)%20%5Cleq%24%20%7Bz_max.value%3A.2f%7D%20%7Bz_max%7D%0A%0A%20%20%20%20%23%23%23%20Some%20notes%0A%0A%20%20%20%20-%20Only%20points%20in%20the%20upper-right%20quadrant%20can%20be%20interepreted%20meaningfully%20as%20noisy%20TMs.%20Points%20in%20other%20quadrants%20correspond%20to%20having%20one%20or%20more%20%22negative%20probabilities%22%20of%20error%20when%20reading%20the%20code%20of%20the%20TM.%0A%20%20%20%20-%20Where%20the%20solver%20can%20find%20it%2C%20we%20indicate%20the%20variety%20%24H_%7B%7Bi%2Cj%7D%7D(x%2Cy)%3D0%24%20in%20pink.%20Reducing%20the%20maximum%20contour%20value%20with%20the%20slider%20above%20may%20aid%20in%20revealing%20the%20curve.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20z_max%20%3D%20mo.ui.slider(start%3D1e-7%2C%20stop%3D2%2C%20step%3D1e-5%2C%20value%3D1)%0A%20%20%20%20return%20(z_max%2C)%0A%0A%0A%40app.cell%0Adef%20_(concentration%2C%20ncontours%2C%20pair_table%2C%20resolution%2C%20z_max)%3A%0A%20%20%20%20from%20scope.surface%20import%20eval_on_grid_2D%0A%0A%20%20%20%20def%20make_2D_H_contour_pyplot(%0A%20%20%20%20%20%20%20%20size%3D1.0%2C%20resolution%3D6%2C%20concentration%3D5%2C%20zmin%3D0%2C%20zmax%3D1%2C%20ncontours%3D10%2C%20**kwargs%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20if%20not%20pair_table.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20levels%20%3D%20np.linspace(zmin%2C%20zmax%2C%20num%3Dncontours%2C%20dtype%3Dnp.float64)%0A%0A%20%20%20%20%20%20%20%20ncols%20%3D%203%0A%20%20%20%20%20%20%20%20nrows%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20len(pair_table.value)%20%2B%20ncols%20-%201%0A%20%20%20%20%20%20%20%20)%20%2F%2F%20ncols%20%20%23%20Calculate%20the%20number%20of%20rows%20needed%0A%0A%20%20%20%20%20%20%20%20fig%2C%20axs%20%3D%20plt.subplots(%0A%20%20%20%20%20%20%20%20%20%20%20%20nrows%3Dnrows%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20ncols%3Dncols%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20figsize%3D(4%20*%20ncols%2C%204%20*%20nrows)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20constrained_layout%3DTrue%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20contour_fills%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20ax%2C%20row%20in%20zip(%0A%20%20%20%20%20%20%20%20%20%20%20%20axs.flatten()%2C%20pair_table.value%0A%20%20%20%20%20%20%20%20)%3A%20%20%23%20Flatten%20the%20axes%20array%20for%201D%20iteration%0A%20%20%20%20%20%20%20%20%20%20%20%20pair%20%3D%20row%5B%22(i%2Cj)%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20pair_ts%20%3D%20row%5B%22Hij(x%2Cy)%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20X%2C%20Y%2C%20values%20%3D%20eval_on_grid_2D(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pair_ts%2C%20resolution%3Dresolution%2C%20bound%3Dsize%2C%20power%3Dconcentration%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.contour(X%2C%20Y%2C%20values%2C%20levels%3D%5B1e-10%5D%2C%20colors%3D%22pink%22%2C%20**kwargs)%0A%20%20%20%20%20%20%20%20%20%20%20%20contour_fill%20%3D%20ax.contourf(X%2C%20Y%2C%20values%2C%20levels%3Dlevels%2C%20**kwargs)%0A%20%20%20%20%20%20%20%20%20%20%20%20contour_fills.append(contour_fill)%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.set_aspect(%22equal%22%2C%20adjustable%3D%22box%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.set_title(f%22%24H_%7B%7B%7Bpair%5B0%5D%7D%2C%7Bpair%5B1%5D%7D%7D%7D(x%2Cy)%24%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20a%20single%20colorbar%20for%20the%20whole%20figure%0A%20%20%20%20%20%20%20%20cbar%20%3D%20fig.colorbar(contour_fills%5B0%5D%2C%20ax%3Daxs%2C%20orientation%3D%22horizontal%22)%0A%20%20%20%20%20%20%20%20cbar.set_label(%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%24z%20%3D%20H_%7Bi%2Cj%7D(x%2Cy)%24%22%0A%20%20%20%20%20%20%20%20)%20%20%23%20Set%20an%20appropriate%20label%20for%20the%20colorbar%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20fig%20%3D%20make_2D_H_contour_pyplot(%0A%20%20%20%20%20%20%20%20resolution%3Dresolution.value%2C%0A%20%20%20%20%20%20%20%20concentration%3Dconcentration.value%2C%0A%20%20%20%20%20%20%20%20zmax%3Dz_max.value%2C%0A%20%20%20%20%20%20%20%20ncontours%3Dncontours.value%2C%0A%20%20%20%20)%0A%20%20%20%20fig%20or%20mo.callout(mo.md(%22No%20%24(i%2Cj)%24%20selected%20in%20the%20table%22)%2C%20kind%3D%22warn%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20resolution%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20value%3D7%2C%0A%20%20%20%20%20%20%20%20start%3D4%2C%0A%20%20%20%20%20%20%20%20stop%3D10%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20debounce%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22Resolution%20(grid%20axes%20%3D%202%5EN%20points)%22%2C%0A%20%20%20%20)%0A%20%20%20%20concentration%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20value%3D5%2C%0A%20%20%20%20%20%20%20%20start%3D1%2C%0A%20%20%20%20%20%20%20%20stop%3D20%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20debounce%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22Concentration%20towards%20xaxis%3D0%20or%20yaxis%3D0%22%2C%0A%20%20%20%20)%0A%20%20%20%20ncontours%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D2%2C%0A%20%20%20%20%20%20%20%20stop%3D50%2C%0A%20%20%20%20%20%20%20%20value%3D10%2C%0A%20%20%20%20%20%20%20%20label%3D%22Number%20of%20contours%22%2C%0A%20%20%20%20%20%20%20%20show_value%3DTrue%2C%0A%20%20%20%20%20%20%20%20debounce%3DTrue%2C%0A%20%20%20%20)%0A%0A%20%20%20%20return%20concentration%2C%20ncontours%2C%20resolution%0A%0A%0A%40app.cell%0Adef%20_(concentration%2C%20ncontours%2C%20resolution)%3A%0A%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20items%3D%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Figure%20Controls%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rf%22%22%22%0A%20%20%20%20Evaluate%20%24H_%7B%7Bi%2Cj%7D%7D(x%2Cy)%24%20on%20%24x%2Cy%20%3D%20%5Cpm%20(2%5E%7B%7B-%7Bresolution.value%7D%7D%7Dn)%20%5E%20%7B%7B%7Bconcentration.value%7D%7D%7D%24%20for%20%240%20%5Cleq%20n%20%5Cleq%202%5E%7B%7B%7Bresolution.value%7D%7D%7D%24%0A%0A%20%20%20%20-%20%7Bresolution%7D%0A%20%20%20%20-%20%7Bconcentration%7D%0A%20%20%20%20-%20%7Bncontours%7D%0A%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%23%23%20References%0A%0A%20%20%20%20%3Col%3E%0A%20%20%20%20%20%20%3Cli%20id%3D%22ref-1%22%3EMurfet%2C%20D.%20and%20Troiani%2C%20W.%2C%202025.%20Programs%20as%20Singularities.%20arXiv%20preprint%20%3Ca%20href%3D%22https%3A%2F%2Farxiv.org%2Fabs%2F2504.08075%22%3EarXiv%3A2504.08075%3C%2Fa%3E.%3C%2Fli%3E%0A%20%20%20%20%20%20%3Cli%20id%3D%22ref-2%22%3EEhrhard%2C%20T.%20and%20Regnier%2C%20L.%2C%202003.%20The%20differential%20lambda-calculus.%20Theoretical%20Computer%20Science%2C%20309(1-3)%2C%20pp.1-41.%3C%2Fli%3E%0A%20%20%20%20%20%20%3Cli%20id%3D%22ref-3%22%3EClift%2C%20J.%20and%20Murfet%2C%20D.%2C%202018.%20Derivatives%20of%20Turing%20machines%20in%20linear%20logic.%20arXiv%20preprint%20arXiv%3A1805.11813.%3C%2Fli%3E%0A%0A%20%20%20%20%3C%2Fol%3E%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.14.16",
            "serverToken": "unused",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
